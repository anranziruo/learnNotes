## 内容

### 锁(悲观锁)
```
1.表级锁：开销小，加锁快；不会出现死锁；锁定粒度大，发生锁冲突的概率最高，并发度最低。
2.行级锁：开销大，加锁慢；会出现死锁；锁定粒度最小，发生锁冲突的概率最低，并发度也最高。
3. 页面锁：开销和加锁时间界于表锁和行锁之间；会出现死锁；锁定粒度界于表锁和行锁之间，并发度一般。
```
### 行锁
#### 读锁 共享锁 （shared lock）
```
即事务A 使用共享锁 获取了某条（或者某些）记录时，事务B 可以读取这些记录，可以继续添加共享锁，但是不能修改或删除这些记录
```
#### 写锁 排它锁（exclusive lock）
```
一个写锁会阻塞其他的读锁和写锁
即事务A 对某些记录添加写锁时，事务B 无法向这些记录添加写锁或者读锁（不添加锁的读取是可以的），事务B 也无法执行对 锁住的数据 update delete
在使用读锁、写锁时都需要注意，读锁、写锁属于行级锁。即事务1 对商品A 获取写锁，和事务2 对商品B 获取写锁互相不会阻塞的。
```
#### 记录锁
MySQL中记录锁都是添加在索引上的，即使表中没有索引，也会在默认创建的聚集索引上添加记录锁。
#### 间隙锁
间隙锁的锁定范围是索引记录之间的间隙，或者第一条或最后一条索引记录之前的间隙
#### 记录锁与间隙锁的组合
Next-Key Lock是记录锁与间隙锁的组合，也就是索引记录本身加上之前的间隙。间 隙锁保证在REPEATABLE-READ级别下不会出现幻读现象，防止在同一个事务内得到的结果不一致
#### 插入意向锁
插入意向锁是针对INSERT操作设置的一种特殊的间隙锁，主要是为了优化INSERT操作的并发能力。这个锁表示插入的意图，即插入具有相同索引间隙的多个事务，如果插入的值不同，则不需要互相等待。

### 死锁

