## 内容

### 锁(悲观锁)
```
1.表级锁：开销小，加锁快；不会出现死锁；锁定粒度大，发生锁冲突的概率最高，并发度最低。
2.行级锁：开销大，加锁慢；会出现死锁；锁定粒度最小，发生锁冲突的概率最低，并发度也最高。
3. 页面锁：开销和加锁时间界于表锁和行锁之间；会出现死锁；锁定粒度界于表锁和行锁之间，并发度一般。
```
### 读锁 共享锁 （shared lock）
```
即事务A 使用共享锁 获取了某条（或者某些）记录时，事务B 可以读取这些记录，可以继续添加共享锁，但是不能修改或删除这些记录
```
### 写锁 排它锁（exclusive lock）
```
一个写锁会阻塞其他的读锁和写锁
即事务A 对某些记录添加写锁时，事务B 无法向这些记录添加写锁或者读锁（不添加锁的读取是可以的），事务B 也无法执行对 锁住的数据 update delete
在使用读锁、写锁时都需要注意，读锁、写锁属于行级锁。即事务1 对商品A 获取写锁，和事务2 对商品B 获取写锁互相不会阻塞的。
```
### 乐观锁
```
乐观锁是一种逻辑锁，通过数据的版本号（vesion）的机制来实现，极大降低了数据库的性能开销。
```
### 锁的优化策略
```
1. 读写分离
2. 分段加锁
3. 减少锁持有的时间
4. 多个线程尽量以相同的顺序去获取资源
```

### 死锁
```
死锁：因为事务争夺资源而造成一种互相等待的情况
解决方案:
1.以固定的顺序执行和方位你的表和行，事务会按照良好的顺序的执行
2.经常提交自己的事务，小事务更少倾向于冲突
```

